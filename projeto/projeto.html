<meta charset="UTF-8">

<h1> DESAFIO: JOGO DA VELHA </h1>
<script>
    var tabuleiro = [    ["", "", ""],
                         ["", "", ""],
                         ["", "", ""]   
                    ];
    var vezDaJogada = 1;
    var estadoDoJogo = 0;
    var linha, coluna;
    const MENSAGENS = { EMPATE: "O jogo empatou!!",
                        JOGADA_INVALIDA_JA_OCUPADO: "Jogada inválida! A posição já está ocupada. Tente novamente.",
                        JOGADA_INVALIDA_NAO_EXISTE: "Jogada inválida! A linha e/ou coluna requisitada não existe. Tente novamente."};

    function exibirTabuleiro() {
        for (let linha=0; linha < tabuleiro.length; linha++) {
            for(let coluna=0; coluna < tabuleiro.length; coluna++){
                document.write( `[${tabuleiro[linha][coluna]} ]`)
            }
        document.write("<br>");       
        }
    }

    function jogar(tabuleiro, jogador, vezDaJogada) {
        var i=0;
        while(i==0){
        alert("A numeração das linhas e colunas do tabuleiro seguem este esquema:\n[0,0][0,1][0,2]\n[1,0][1,1][1,2]\n[2,0][2,1][2,2]");
        linha = +prompt(`Rodada ${vezDaJogada}. Participante ${jogador}, escolha a linha [0, 1 ou 2] que deseja jogar:`);
        coluna = +prompt(`Rodada ${vezDaJogada}. Participante ${jogador}, escolha a coluna [0, 1 ou 2] que deseja jogar:`);
    
        // Verificação da jogada - descomentar quando as verificações de vitória, empate e continuação forem finalizadas
        // if(linha>=3 || coluna>=3){
        //     alert(MENSAGENS.JOGADA_INVALIDA_NAO_EXISTE);
        // }
        // else if(tabuleiro[linha][coluna]!=""){
        //     alert(MENSAGENS.JOGADA_INVALIDA_JA_OCUPADO);
        // }
        // else{
             tabuleiro[linha][coluna] = jogador;
             i=1;
        // }
    }
}

// Verificações
    function verificarLinha(tabuleiro, jogador) {
        for (let linha = 0; linha < 3; linha++) {
            if (tabuleiro[linha][0] === tabuleiro[linha][1] && tabuleiro[linha][1] === tabuleiro[linha][2] && tabuleiro[linha][0] === jogador) {
                document.write(`PARABÉNS! O jogador ${jogador} venceu a partida!`);
                return estadoDoJogo=1;
            }
        }
    }

    function verificarColuna(tabuleiro, jogador){
        for (let coluna = 0; coluna < 3; coluna++) {
            if (tabuleiro[0][coluna] === tabuleiro[1][coluna] && tabuleiro[1][coluna] === tabuleiro[2][coluna] && tabuleiro[0][coluna] === jogador) {
                document.write(`PARABÉNS! O jogador ${jogador} venceu a partida!`);
                return estadoDoJogo = 1;
            }
        }
    }

    function verificarDiagonais(tabuleiro, jogador){
        if(tabuleiro[0][0] === tabuleiro[1][1] && tabuleiro[1][1] === tabuleiro[2][2] && tabuleiro[0][0] === jogador){
            document.write(`PARABÉNS! O jogador ${jogador} venceu a partida!`);
            return estadoDoJogo = 1;
        }
        else if(tabuleiro[0][2] === tabuleiro[1][1] && tabuleiro[1][1] === tabuleiro[2][0] && tabuleiro[0][2] === jogador){
            document.write(`PARABÉNS! O jogador ${jogador} venceu a partida!`);
            return estadoDoJogo = 1;
        }
    }

    function verificarEmpate(tabuleiro){
        let posicoesPreenchidas = 0;
        for (let linha = 0; linha < 3; linha++) {
            for (let coluna = 0; coluna < 3; coluna++) {
                if (tabuleiro[linha][coluna] != "") {
                    posicoesPreenchidas = posicoesPreenchidas + 1;
                }
            }
        }
        if (posicoesPreenchidas == 9) {
            document.write(MENSAGENS.EMPATE);
            return estadoDoJogo = 1;
        }
    }

// Definindo os símbolos dos jogadores
    alert("JOGO DA VELHA!");

    var i = 0;
    var JOGADOR2;
        while(i==0){
            var jogador1 = prompt("Escolha X ou O para usar durante o jogo: ");
            var JOGADOR1 = jogador1.toUpperCase()

            if(JOGADOR1 != "X" && JOGADOR1 != "O"){
                alert("Símbolo inválido. Por favor, escolha entre X ou O!");
            }
            else{
                if (JOGADOR1 == "X"){
                    JOGADOR2 = "O"; 
                }
                else{
                    var JOGADOR2 = "X";   
                }
                document.write(`O símbolo do Jogador 1 é: ${JOGADOR1}. O símbolo do Jogador 2 é: ${JOGADOR2}.` + "<br>")
                i = 1;
            }
        }

// Execução do jogo:
    while(estadoDoJogo==0){
    // Jogador 1
        document.write("<br><br>" + (`Rodada ${vezDaJogada}!`).bold() + "<br><br>");
        document.write(`Jogador ${JOGADOR1}` + "<br><br>");
        jogar(tabuleiro, JOGADOR1, vezDaJogada);
        exibirTabuleiro();

        verificarLinha(tabuleiro, JOGADOR1);
        verificarColuna(tabuleiro, JOGADOR1);
        verificarDiagonais(tabuleiro, JOGADOR1);
        verificarEmpate(tabuleiro);

    // Jogador 2
        document.write("<br>"+ `Jogador ${JOGADOR2}` + "<br><br>");
        jogar(tabuleiro, JOGADOR2, vezDaJogada);
        exibirTabuleiro();

        verificarLinha(tabuleiro, JOGADOR2);
        verificarColuna(tabuleiro, JOGADOR2);
        verificarDiagonais(tabuleiro, JOGADOR2);
        verificarEmpate(tabuleiro);

        vezDaJogada++;
    }
</script>
